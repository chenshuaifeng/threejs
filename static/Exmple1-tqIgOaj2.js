import{V as I,C as G,d as _,e as B,H as R,f as z,N as q,a as W,S as D,c as H,P as T,W as A,g as F,D as N,h as U,i as O,j as V}from"./three.module-B48SNEox.js";import{d as J}from"./dat.gui.module-DqesmVVB.js";import{O as K}from"./OrbitControls-BQkA2Aq0.js";import{l as Q,r as E,d as X,m as Y,p as Z,q as $}from"./vue-SvvCd1mE.js";import{_ as ee}from"./index-HC9wGKDV.js";import"./element-C1lpoOYO.js";import"./vxe-YBxjpzKi.js";class te{static fromCubeTexture(w){let h=0;const n=new I,t=new I,s=new G,g=[0,0,0,0,0,0,0,0,0],u=new _,b=u.coefficients;for(let l=0;l<6;l++){const y=w.image[l],a=y.width,e=y.height,o=document.createElement("canvas");o.width=a,o.height=e;const C=o.getContext("2d");C.drawImage(y,0,0,a,e);const d=C.getImageData(0,0,a,e),p=d.data,r=d.width,x=2/r;for(let i=0,v=p.length;i<v;i+=4){s.setRGB(p[i]/255,p[i+1]/255,p[i+2]/255),j(s,w.colorSpace);const S=i/4,m=-1+(S%r+.5)*x,k=1-(Math.floor(S/r)+.5)*x;switch(l){case 0:n.set(-1,k,-m);break;case 1:n.set(1,k,m);break;case 2:n.set(-m,1,-k);break;case 3:n.set(-m,-1,k);break;case 4:n.set(-m,k,1);break;case 5:n.set(m,k,-1);break}const L=n.lengthSq(),f=4/(Math.sqrt(L)*L);h+=f,t.copy(n).normalize(),_.getBasisAt(t,g);for(let P=0;P<9;P++)b[P].x+=g[P]*s.r*f,b[P].y+=g[P]*s.g*f,b[P].z+=g[P]*s.b*f}}const c=4*Math.PI/h;for(let l=0;l<9;l++)b[l].x*=c,b[l].y*=c,b[l].z*=c;return new B(u)}static fromCubeRenderTarget(w,h){let n=0;const t=new I,s=new I,g=new G,u=[0,0,0,0,0,0,0,0,0],b=new _,c=b.coefficients,l=h.texture.type;for(let a=0;a<6;a++){const e=h.width;let o;l===R?o=new Uint16Array(e*e*4):o=new Uint8Array(e*e*4),w.readRenderTargetPixels(h,0,0,e,e,o,a);const C=2/e;for(let d=0,p=o.length;d<p;d+=4){let r,x,i;l===R?(r=z.fromHalfFloat(o[d]),x=z.fromHalfFloat(o[d+1]),i=z.fromHalfFloat(o[d+2])):(r=o[d]/255,x=o[d+1]/255,i=o[d+2]/255),g.setRGB(r,x,i),j(g,h.texture.colorSpace);const v=d/4,S=-1+(v%e+.5)*C,m=1-(Math.floor(v/e)+.5)*C;switch(a){case 0:t.set(1,m,-S);break;case 1:t.set(-1,m,S);break;case 2:t.set(S,1,-m);break;case 3:t.set(S,-1,m);break;case 4:t.set(S,m,1);break;case 5:t.set(-S,m,-1);break}const k=t.lengthSq(),L=4/(Math.sqrt(k)*k);n+=L,s.copy(t).normalize(),_.getBasisAt(s,u);for(let f=0;f<9;f++)c[f].x+=u[f]*g.r*L,c[f].y+=u[f]*g.g*L,c[f].z+=u[f]*g.b*L}}const y=4*Math.PI/n;for(let a=0;a<9;a++)c[a].x*=y,c[a].y*=y,c[a].z*=y;return new B(b)}}function j(M,w){switch(w){case D:M.convertSRGBToLinear();break;case W:case q:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return M}const ne=Q({name:"Exmple1",__name:"Exmple1",setup(M){let w=0,h=0;const n=new H,t=new T(45,window.innerWidth/window.innerHeight,.1,2e3);t.position.set(0,0,30);const s=new A({antialias:!0});s.render(n,t);const g=new K(t,s.domElement);g.enableDamping=!0;let u;const b=new F().setPath("texture/exmple1/").load(["px.png","nx.png","py.png","ny.png","pz.png","nz.png"],x=>{const i=te.fromCubeTexture(x);u=new B,u.copy(i),n.add(u)}),c=new N(16777215,1);c.intensity=1,c.position.set(-10,15,0),n.add(c),n.background=b;const l=new U(5,32,32),y=new O({color:16777215,envMap:b,envMapIntensity:1,roughness:0,metalness:.2}),a=new V(l,y);n.add(a);const e=()=>{s.render(n,t)},o=()=>{requestAnimationFrame(o),s.setSize(w,h),t.updateProjectionMatrix(),g.update(),e()};o();const C=E(),d=E(),p=new J.GUI;p.addFolder("threjs配置").open();const r={roughness:0,metalness:.2,lightProbeIntensity:1,directionalLight:.6};return p.add(r,"roughness",0,1,.01).name("roughness").onChange(()=>{y.roughness=r.roughness,e()}),p.add(r,"metalness",0,1,.01).name("metalness").onChange(()=>{y.metalness=r.metalness,e()}),p.add(r,"lightProbeIntensity",0,1,.01).name("lightProbe").onChange(()=>{u.intensity=r.lightProbeIntensity,e()}),p.add(r,"directionalLight",0,1,.01).name("directionalLight").onChange(()=>{c.intensity=r.directionalLight,e()}),X(()=>{var i;const x=C.value.getBoundingClientRect();w=x.width,h=x.height,s.setSize(w,h),C.value.appendChild(s.domElement),(i=d.value)==null||i.appendChild(p.domElement),window.addEventListener("resize",()=>{s.setSize(w,h),t.aspect=w/h,t.updateProjectionMatrix(),e()})}),(x,i)=>(Y(),Z("div",{ref_key:"sceneRef",ref:C,class:"right-box"},[$("div",{ref_key:"guiRef",ref:d,id:"gui",class:"gui-box"},null,512)],512))}}),de=ee(ne,[["__scopeId","data-v-e436aba0"]]);export{de as default};
